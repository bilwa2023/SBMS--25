<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>User Registration</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    form { max-width: 500px; margin-bottom: 20px; }
    input, textarea, select { width: 100%; padding: 8px; margin: 5px 0; }
    button { padding: 8px 15px; margin-top: 10px; cursor: pointer; }
    #preview { background: #f5f5f5; padding: 15px; margin-top: 20px; }
  </style>
</head>
<body>
  <h2>User Registration Form</h2>

  <form  id="userForm">
    <input type="text" name="fullname" placeholder="Full Name" required><br>
    <input type="email" name="email" placeholder="Email" required><br>
    <input type="text" name="phoneno" placeholder="Phone Number" required><br>
    <input type="text" name="highest_qualification" placeholder="Highest Qualification" required><br>
    <input type="text" name="college_name" placeholder="College Name" required><br>
    <textarea name="address" placeholder="Address"></textarea><br>
    
    <label>Gender:</label>
    <select name="gender" required>
      <option value="">--Select--</option>
      <option value="Male">Male</option>
      <option value="Female">Female</option>
      <option value="Other">Other</option>
    </select><br>
    
    <input type="number" name="experience" placeholder="Experience (years)" min="0"><br>
    
    <button type="submit">Preview</button>
  </form>

  <h3>Preview:</h3>
  <div id="preview"></div>

  <script>
    const form = document.getElementById('userForm');
    const preview = document.getElementById('preview');

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const formData = Object.fromEntries(new FormData(form).entries());

      // Show Preview
      preview.innerHTML = `
        <p><b>Name:</b> ${formData.fullname}</p>
        <p><b>Email:</b> ${formData.email}</p>
        <p><b>Phone:</b> ${formData.phoneno}</p>
        <p><b>Qualification:</b> ${formData.highest_qualification}</p>
        <p><b>College:</b> ${formData.college_name}</p>
        <p><b>Address:</b> ${formData.address}</p>
        <p><b>Gender:</b> ${formData.gender}</p>
        <p><b>Experience:</b> ${formData.experience} years</p>
        <button id="confirm">Confirm & Save</button>`;

      // Handle Save on Confirm
document.getElementById('confirm').addEventListener('click', async () => {
  try {
    let res = await fetch('http://localhost:8080/save', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(formData)
    });

    if (!res.ok) {
      throw new Error("Failed to save! Status: " + res.status);
    }

    let data = await res.json();
    alert("Details saved! ID = " + data.id + ". You can now download PDF.");
    window.location.href = `http://localhost:8080/download/${data.id}`;
  } catch (err) {
    alert("Error: " + err.message);
    console.error(err);
  }
});

    });
  </script>
</body>
</html>
